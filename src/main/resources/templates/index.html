<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head th:replace="fragments/head :: head">
    <title th:text="${title}">Home - Donation App</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <style>
    /* Keeping your blur effect for recent donations rows */
    .blur-row {
      filter: blur(5px);
      pointer-events: none;
    }

    .blur-row:hover {
      filter: none;
      pointer-events: auto;
    }
  </style>
  <body class="flex flex-col min-h-screen font-sans bg-gray-50 text-gray-800">
    <header th:replace="fragments/header :: header"></header>

    <!-- Hero Section -->
    <main class="flex-grow">
      <section
        class="hero-section flex flex-col items-center justify-center bg-gradient-to-r from-green-400 to-blue-500 text-white p-16 text-center"
      >
        <div class="container mx-auto">
          <h2 class="text-6xl font-extrabold mb-6 leading-tight">
            Support Our Cause
          </h2>
          <p class="text-lg mb-10 max-w-2xl mx-auto">
            Your donations help us make a significant impact and create a
            brighter future for those in need.
          </p>
          <a
            href="/donate"
            class="inline-block bg-yellow-500 text-white px-8 py-4 rounded-full font-bold hover:bg-yellow-600 transition-all duration-300"
            >Donate Now</a
          >
        </div>
      </section>

      <!-- Statistics Section -->
      <section class="bg-white py-16 shadow-lg">
        <div class="container mx-auto text-center">
          <h3 class="text-3xl font-bold mb-12">Our Impact</h3>
          <div class="flex flex-wrap justify-center gap-16">
            <div class="text-center">
              <p class="text-6xl font-extrabold text-blue-500">150+</p>
              <p class="mt-2 text-gray-600">Campaigns Run</p>
            </div>
            <div class="text-center">
              <p class="text-6xl font-extrabold text-blue-500">5000+</p>
              <p class="mt-2 text-gray-600">Donors Contributed</p>
            </div>
            <div class="text-center">
              <p class="text-6xl font-extrabold text-blue-500">$1M+</p>
              <p class="mt-2 text-gray-600">Raised for Charity</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Map Section -->
      <section class="py-16 bg-gray-100">
        <div class="container mx-auto">
          <h3 class="text-3xl font-bold text-center mb-6">Our Students</h3>
          <p class="text-center mb-12 max-w-3xl mx-auto text-lg">
            We support students all around the region to ensure they have the
            resources they need to succeed.
          </p>
          <div
            id="map"
            style="width: 100%; height: 500px"
            class="shadow-md rounded-md border-4 border-gray-200"
          ></div>
        </div>
      </section>

      <!-- Recent Donations Section -->
      <!-- Recent Donations Section -->
      <section class="mt-10 bg-white py-16">
        <div class="container mx-auto">
          <h3 class="text-3xl font-bold text-center mb-10">Recent Donations</h3>
          <div
            class="overflow-hidden border border-gray-200 rounded-lg shadow-lg"
          >
            <table class="min-w-full bg-white">
              <thead class="bg-gray-100">
                <tr>
                  <th
                    class="py-4 px-6 border-b text-left text-sm font-semibold text-gray-600 uppercase tracking-wider"
                  >
                    ID
                  </th>
                  <th
                    class="py-4 px-6 border-b text-left text-sm font-semibold text-gray-600 uppercase tracking-wider"
                  >
                    Amount
                  </th>
                  <th
                    class="py-4 px-6 border-b text-left text-sm font-semibold text-gray-600 uppercase tracking-wider"
                  >
                    Donor Name
                  </th>
                  <th
                    class="py-4 px-6 border-b text-left text-sm font-semibold text-gray-600 uppercase tracking-wider"
                  >
                    Date
                  </th>
                  <th
                    class="py-4 px-6 border-b text-left text-sm font-semibold text-gray-600 uppercase tracking-wider"
                  >
                    Campaign
                  </th>
                  <th
                    class="py-4 px-6 border-b text-left text-sm font-semibold text-gray-600 uppercase tracking-wider"
                  >
                    Payment Method
                  </th>
                </tr>
              </thead>
              <tbody id="donationsTableBody" class="divide-y divide-gray-200">
                <!-- Example Donation Row (Replace or populate dynamically) -->

                <!-- Add more rows dynamically -->
              </tbody>
            </table>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <div th:replace="fragments/footer :: footer"></div>

    <!-- jQuery via CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Map Initialization Script -->
    <script>
      const map = new maplibregl.Map({
        container: "map",
        style: "https://tiles.openfreemap.org/styles/liberty",
        center: [114.1694, 22.3193], // Centered over Kowloon, Hong Kong
        zoom: 9.5,
      });

      map.addControl(new maplibregl.NavigationControl());

      // Fetch student data from the backend
      $.ajax({
        url: "/api/v1/student",
        method: "GET",
        success: function (students) {
          students.forEach(function (student) {
            const el = document.createElement("div");
            el.style.backgroundImage =
              "url(https://static.vecteezy.com/system/resources/previews/000/350/111/non_2x/vector-male-student-icon.jpg)";
            el.style.width = "50px";
            el.style.height = "50px";
            el.style.backgroundSize = "100%";

            // Create a marker for each student
            new maplibregl.Marker({ element: el })
              .setLngLat([student.longitude, student.latitude])
              .setPopup(
                new maplibregl.Popup({ offset: 25 }).setHTML(
                  `<h3>${student.name}</h3>
               <p>${student.school}</p>
               <a href="/student-profile?id=${student.id}" target="_blank" style="color: blue; text-decoration: underline;">View Profile</a>`
                )
              )
              .addTo(map);
          });
        },
        error: function (error) {
          console.error("Error fetching student data:", error);
        },
      });
    </script>

    <script src="/js/app.js"></script>
  </body>
</html>
